{% extends 'base.html.twig' %}

{% block title %}Mes exercices
{% endblock %}


{% block body %}

	{% if is_granted('ROLE_EDITOR') %}
		{% set route = "editor" %}
	{% else %}
		{% set route = "profile"%}
	{% endif %}


	<table class="table table-hover">


		<tbody>

			{% for lesson in app.user.lessons %}

				<td>
					<a href="{{path('profile_show_cours', {'id' : lesson.id})}}">
						<div style="height:100%;width:100%">
							<h3>{{lesson.title}}</h3>
						</div>
					</a>
				</td>

				<table class="table table-hover">
					{% if is_granted('ROLE_EDITOR') %}
						<thead>
							<tr>
								<th>Exercice</th>
								<th>Taux de r√©ussite</th>
								<th>Nombre de tentative</th>
							</tr>
						</thead>
					{% endif %}

					<tbody>
						{% for exercise in lesson.exercises %}

							{% if app.user.getNotation(exercise) == null %}
								{% set status = "table-secondary" %}
							{% elseif app.user.getNotation(exercise).getNote == 100 %}
								{% set status = "table-success"%}
							{% elseif app.user.getNotation(exercise).getNote >= 50 %}
								{% set status = "table-warning" %}
							{% else %}
								{% set status = "table-danger" %}
							{% endif %}

							<tr class="{{status}}">
								<td>
									<a href="{{path(route ~'_show_exercises', {'id1' : lesson.id, 'id2' : exercise.id})}}">
										<div style="height:100%;width:100%">
											{{exercise.title}}
										</div>
									</a>
								</td>

								{% if is_granted('ROLE_EDITOR') %}
									<td>{{exercise.success_rate}}</td>
									<td>{{exercise.attempts}}</td>
								{% endif %}
							</tr>
						{% endfor %}
					</tbody>
				{% endfor %}
			</table>

		</tbody>
	</table>
{% endblock %}
